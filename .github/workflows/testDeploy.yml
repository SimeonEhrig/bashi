name: test-and-deploy
on: [push, pull_request]
jobs:
    formatter:
        name: runner black code formatter
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v4
        - uses: psf/black@stable
          with:
            options: "--check --verbose"
            src: "./"
            version: "~= 24.0"

    unit-tests:
        runs-on: ubuntu-latest
        needs: formatter
        strategy:
            matrix:
                python-version: ['3.10', '3.11', '3.12']
        name: Run unit tests with Python ${{ matrix.python-version }}
        steps:
            - uses: actions/checkout@v4
            - name: Set up Python
              uses: actions/setup-python@v3
              with:
                python-version: ${{ matrix.python-version }}
                architecture: x64
            - name: Install bashi
              run: |
                pip install .
            - name: run unit tests
              run: python -m unittest discover -s tests
